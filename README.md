# Stripeproject
Добрый день! Вы находитесь на странице репозитория с тестовым заданием на написание веб-сервиса с API платежной системы Stripe.

# Для запуска:
1) Клонировать репозиторий командой 
```git clone https://github.com/Bpem9/Stripeproject.git```
2) Находясь в директории с docker-compose.yaml, выполнить команду docker-compose up. Перед запуском убедитесь, что докер запущен на рабочем компьютере
3) После запуска приложения, на локальном хосте (http://127.0.0.1:8000/) станет доступно API-приложение со следующими эндпоинтами:
```
item/ - список товаров, с возможностью создания
item/<pk> - детальное отображение товара по индексу
order/ - список товаров, с возможностью создания
order/<pk> - детальное отображение заказа по индексу
```
4) Для запуска напрямую через django необходимо установить виртуальное окружение командами: 
```
python -m venv venv
pip install -r requirements.txt
```
находясь в директории с файлом requirements.txt

# Общая информация
Образ включает в себя слои django и PostgreSQL.
Приложение выполнено с использованием wait-for-it - скрипта ожидания запуска контейнера с PostgreSQL (иначе, django пытается подключиться к БД, которая еще не запустилась)
В качестве рендерера принят стандартный для django REST BrowsableAPIRenderer, отображающий JSON-данные с использованием дефолтного интерфейса REST, а детальное отображение заказов и товаров выполнено с использованием кастомного HTML-шаблона, предоставленного заказчиком.
На репозиторий временно выложен .env файл, в котором прописаны переменные окружения для БД, stripe, django. Файл выложен в целях демонстрации тестового задания и будет удален после рассмотрения заказчиком. Данные суперпользователя также выкладываются сюда временно, с целью проверки тестового задания
login: root
password: 1234

# Реализация тестовых заданий:
1) Модель item, находящаяся на эндпоинте 'item/', с возможностью детального просмотра через индекс
2) Создание торговой сессии Stripe при нажатии на кнопку 'buy' - переход на эндпоинт 'buy/<>', который запускает функцию stripe.checkout.session.create и передает индекс товара.
3) Решение опубликовано на GitHub
4) Реализована контейнеризация приложения с базой данных
5) Реализована модель Order, содержащая в себе несколько экземпляров модели Item. При переходе на 'buy/' из детальной страницы Order, создается объект stripe.PaymentIntent на сумму стоимостей всех товаров в экземпляре Order
6) Передача скрытых данных производится с помощью переменных окружения
7) Реализована админка, по эндпоинту 'admin/', с возможностью просмотра и редактирования моделей Item и Order
8) Реализована возможность создания новых товаров в базе данных Stripe, для применения их в последующих сессиях
